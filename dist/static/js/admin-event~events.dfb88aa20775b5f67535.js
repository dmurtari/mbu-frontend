(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+X84":function(e,t,n){"use strict";var s=n("DsQ8");n.n(s).a},DsQ8:function(e,t,n){},YjRr:function(e,t,n){"use strict";var s=n("fvdt");n.n(s).a},fvdt:function(e,t,n){},iPre:function(e,t,n){},"nhC+":function(e,t,n){"use strict";var s=n("iPre");n.n(s).a},zruM:function(e,t,n){"use strict";n.r(t);var s=n("QbLZ"),a=n.n(s),i=n("L2JU"),r=n("fBmq"),o=n("wd/R"),l=n.n(o),c=n("ta7f"),v=n("v8uP"),d={data:function(){return{eventUpdate:{date:"",registration_open:"",registration_close:"",price:""},error:"",showDeleteConfirmation:!1,saving:!1,settingCurrent:!1}},props:{event:{type:Object,required:!0}},computed:{semesterAndYear:function(){return this.event.semester+" "+this.event.year}},methods:{updateEvent:function(){var e=this;this.saving=!0;var t={id:this.event.id,date:l()(this.eventUpdate.date,"MM/DD/YYYY"),registration_open:l()(this.eventUpdate.registration_open,"MM/DD/YYYY"),registration_close:l()(this.eventUpdate.registration_close,"MM/DD/YYYY"),price:this.eventUpdate.price};this.$store.dispatch("updateEvent",t).then(function(){return console.log("Getting new events"),e.$store.dispatch("getEvents")}).then(function(){console.log("Closing"),e.close()}).catch(function(t){console.log("Error"),e.error=t}).then(function(){console.log("Done"),e.saving=!1})},deleteEvent:function(){var e=this;this.$store.dispatch("deleteEvent",this.event.id).then(function(){e.$store.dispatch("getEvents"),e.$emit("close")}).catch(function(){e.error="There was a problem deleting this event."})},setAsCurrent:function(){var e=this;this.settingCurrent=!0,this.$store.dispatch("saveCurrentEvent",this.event.id).then(function(){return e.$store.dispatch("getEvents")}).then(function(){e.$emit("close")}).catch(function(){e.error="Failed to set this event as current."}).then(function(){e.settingCurrent=!1})},showDeleteConfirm:function(){this.showDeleteConfirmation=!0},hideDeleteConfirm:function(){this.showDeleteConfirmation=!1},close:function(){this.$emit("close")}},mounted:function(){this.eventUpdate.date=l()(this.event.date).format("MM/DD/YYYY"),this.eventUpdate.registration_open=l()(this.event.registration_open).format("MM/DD/YYYY"),this.eventUpdate.registration_close=l()(this.event.registration_close).format("MM/DD/YYYY"),this.eventUpdate.price=this.event.price},validations:{eventUpdate:{date:{required:c.required,date:Object(v.d)("MM/DD/YYYY")},registration_open:{required:c.required,date:v.d,beforeDate:Object(v.a)("date")},registration_close:{required:c.required,date:v.d,betweenDate:Object(v.b)("registration_open","date")},price:{required:c.required}}}},u=n("KHd+"),p=Object(u.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.error?n("div",{staticClass:"notification is-danger"},[n("p",[e._v("\n      "+e._s(e.error)+"\n    ")])]):e._e(),e._v(" "),e.showDeleteConfirmation?e._e():n("form",[n("div",{staticClass:"columns is-multiline"},[n("div",{staticClass:"field column is-6"},[n("label",{staticClass:"label",attrs:{for:"event-edit-price"}},[e._v("Registration Fee")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.eventUpdate.price.$error},attrs:{mask:"11.11",placeholder:"00.00",id:"event-edit-price"},on:{blur:e.$v.eventUpdate.price.$touch},model:{value:e.eventUpdate.price,callback:function(t){e.$set(e.eventUpdate,"price",t)},expression:"eventUpdate.price"}})],1),e._v(" "),e.$v.eventUpdate.price.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter the price of the event (or 00.00)\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-6"},[n("label",{staticClass:"label",attrs:{for:"event-edit-date"}},[e._v("Date")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.eventUpdate.date.$error},attrs:{mask:"11/11/1111",placeholder:"mm/dd/yyyy",id:"event-edit-date"},on:{blur:e.$v.eventUpdate.date.$touch},model:{value:e.eventUpdate.date,callback:function(t){e.$set(e.eventUpdate,"date",t)},expression:"eventUpdate.date"}})],1),e._v(" "),e.$v.eventUpdate.date.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid date for this event\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-6"},[n("label",{staticClass:"label",attrs:{for:"event-edit-open"}},[e._v("Registration Opens")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.eventUpdate.registration_open.$error},attrs:{mask:"11/11/1111",placeholder:"mm/dd/yyyy",id:"event-edit-open"},on:{blur:e.$v.eventUpdate.registration_open.$touch},model:{value:e.eventUpdate.registration_open,callback:function(t){e.$set(e.eventUpdate,"registration_open",t)},expression:"eventUpdate.registration_open"}})],1),e._v(" "),e.$v.eventUpdate.registration_open.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid date for registration opening, before the day of the event\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-6"},[n("label",{staticClass:"label",attrs:{for:"event-edit-close"}},[e._v("Registration Closes")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.eventUpdate.registration_close.$error},attrs:{mask:"11/11/1111",placeholder:"mm/dd/yyyy",id:"event-create-close"},on:{blur:e.$v.eventUpdate.registration_close.$touch},model:{value:e.eventUpdate.registration_close,callback:function(t){e.$set(e.eventUpdate,"registration_close",t)},expression:"eventUpdate.registration_close"}})],1),e._v(" "),e.$v.eventUpdate.registration_close.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid date for registration closing, between registration opening\n          and the event day\n        ")]):e._e()])]),e._v(" "),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",class:{"is-loading":e.saving},attrs:{disabled:e.$v.$invalid||e.saving},on:{click:function(t){t.preventDefault(),e.updateEvent()}}},[e._v("Update Event")])]),e._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-default",attrs:{disabled:e.saving},on:{click:function(t){t.preventDefault(),e.close()}}},[e._v("Cancel")])]),e._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-text",class:{"is-loading":e.settingCurrent},attrs:{disabled:e.settingCurrent||e.saving},on:{click:function(t){t.preventDefault(),e.setAsCurrent()}}},[e._v("Set as the Current Event")])]),e._v(" "),n("div",{staticClass:"control is-pulled-right"},[n("button",{staticClass:"button is-danger is-pulled-right",attrs:{disabled:e.saving},on:{click:function(t){t.preventDefault(),e.showDeleteConfirm()}}},[e._v("Delete Event")])])])]),e._v(" "),e.showDeleteConfirmation?n("confirm-delete",{staticClass:"container-fluid",attrs:{"match-text":this.semesterAndYear,placeholder:"Summer 2008"},on:{deleteSuccess:function(t){e.deleteEvent()},close:function(t){e.hideDeleteConfirm()}}},[n("span",{attrs:{slot:"header"},slot:"header"},[e._v("\n      Do you really want to delete this event? This cannot be undone, and will likely break\n      existing registration records!\n    ")]),e._v(" "),n("span",{attrs:{slot:"help-text"},slot:"help-text"},[e._v("\n      Enter the semester and year to confirm deletion.\n      "),n("b",[e._v("This action cannot be undone, and will also remove all data associated with\n        this event, including registrations and completion records.")])])]):e._e()],1)},[],!1,null,null,null).exports,_=n("d8BS"),h={data:function(){return{displayEditEvent:!1}},computed:a()({},Object(i.b)(["isAdmin"])),props:{event:{type:Object,required:!0},currentEvent:{type:Boolean}},methods:{toggleEdit:function(){this.displayEditEvent=!this.displayEditEvent}},components:{"event-edit":p,"event-detail":_.a}},g=(n("YjRr"),Object(u.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box",class:{"panel-info":e.currentEvent}},[n("h4",{staticClass:"title is-4"},[e._v("\n    "+e._s(e.event.semester)+" "+e._s(e.event.year)+"\n    "),e.currentEvent?n("span",[e._v("(Current Event)")]):e._e(),e._v(" "),e.isAdmin?n("button",{staticClass:"button edit-button is-pulled-right",on:{click:e.toggleEdit}},[n("span",{staticClass:"fa fa-edit",attrs:{"aria-label":"Edit"}})]):e._e()]),e._v(" "),e.displayEditEvent?e._e():n("event-detail",{attrs:{event:e.event}}),e._v(" "),e.displayEditEvent?n("event-edit",{attrs:{event:e.event},on:{close:e.toggleEdit}}):e._e()],1)},[],!1,null,"6a006daf",null).exports),f=n("LvDl"),m=n.n(f),b={data:function(){return{event:{year:"",semester:"",date:"",registration_open:"",registration_close:"",price:""},semesters:[{text:"Spring",value:"Spring"},{text:"Fall",value:"Fall"}],error:"",current:!1,creating:!1}},methods:{createEvent:function(){var e=this;this.creating=!0;var t={year:Number(this.event.year),semester:this.event.semester,date:l()(this.event.date,"MM/DD/YYYY"),registration_open:l()(this.event.registration_open,"MM/DD/YYYY"),registration_close:l()(this.event.registration_close,"MM/DD/YYYY"),price:Number(this.event.price)};this.$store.dispatch("addEvent",t).then(function(t){if(e.current)return e.$store.dispatch("saveCurrentEvent",t.id)}).then(function(){return e.$store.dispatch("getEvents")}).then(function(t){e.$v.$reset(),e.creating=!1,e.clearAndClose()}).catch(function(t){e.creating=!1,e.error=t})},clearAndClose:function(){var e=this;m.a.forEach(this.event,function(t,n){e.event[n]=""}),this.error="",this.close()},close:function(){this.$emit("close")}},validations:{event:{year:{required:c.required,date:Object(v.d)("YYYY")},semester:{required:c.required},date:{required:c.required,date:Object(v.d)("MM/DD/YYYY")},registration_open:{required:c.required,date:v.d,beforeDate:Object(v.a)("date")},registration_close:{required:c.required,date:v.d,betweenDate:Object(v.b)("registration_open","date")},price:{required:c.required}}}},C=(n("+X84"),Object(u.a)(b,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"},[n("h4",{staticClass:"title is-4"},[e._v("Create an Event")]),e._v(" "),n("p",[e._v("\n    Fill out the information below to create a new Merit Badge University event. To add\n    merit badges that will be offered at this event, go to\n    "),n("router-link",{attrs:{to:"/administration"}},[e._v(" the administration page")]),e._v(".\n  ")],1),e._v(" "),n("br"),e._v(" "),e.error?n("div",{staticClass:"notification is-danger"},[n("p",[e._v("\n      "+e._s(e.error)+"\n    ")])]):e._e(),e._v(" "),n("form",[n("div",{staticClass:"columns is-multiline"},[n("div",{staticClass:"field column is-4"},[n("label",{staticClass:"label",attrs:{for:"event-create-year"}},[e._v("Year")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.event.year.$error},attrs:{mask:"1111",placeholder:"yyyy",id:"event-create-year"},on:{blur:e.$v.event.year.$touch},model:{value:e.event.year,callback:function(t){e.$set(e.event,"year",t)},expression:"event.year"}})],1),e._v(" "),e.$v.event.year.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid year\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-4"},[n("label",{staticClass:"label",attrs:{for:"event-create-semester"}},[e._v("Semester")]),e._v(" "),n("div",{staticClass:"control"},[n("span",{staticClass:"select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.event.semester,expression:"event.semester"}],staticClass:"input",class:{"is-danger":e.$v.event.semester.$error},attrs:{id:"event-create-semester"},on:{blur:e.$v.event.semester.$touch,change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.event,"semester",t.target.multiple?n:n[0])}}},e._l(e.semesters,function(t){return n("option",{key:t.value,domProps:{value:t.value}},[e._v("\n                "+e._s(t.text)+"\n              ")])}))])]),e._v(" "),e.$v.event.semester.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please pick a semester for this event\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-4"},[n("label",{staticClass:"label",attrs:{for:"event-create-price"}},[e._v("Registration Fee")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.event.price.$error},attrs:{mask:"11.11",placeholder:"00.00",id:"event-create-price"},on:{blur:e.$v.event.price.$touch},model:{value:e.event.price,callback:function(t){e.$set(e.event,"price",t)},expression:"event.price"}})],1),e._v(" "),e.$v.event.price.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter the price of the event (or 00.00)\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-4"},[n("label",{staticClass:"label",attrs:{for:"event-create-date"}},[e._v("Date")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.event.date.$error},attrs:{mask:"11/11/1111",placeholder:"mm/dd/yyyy",id:"event-create-date"},on:{blur:e.$v.event.date.$touch},model:{value:e.event.date,callback:function(t){e.$set(e.event,"date",t)},expression:"event.date"}})],1),e._v(" "),e.$v.event.date.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid date for this event\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-4"},[n("label",{staticClass:"label",attrs:{for:"event-create-open"}},[e._v("Registration Opens")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.event.registration_open.$error},attrs:{mask:"11/11/1111",placeholder:"mm/dd/yyyy",id:"event-create-open"},on:{blur:e.$v.event.registration_open.$touch},model:{value:e.event.registration_open,callback:function(t){e.$set(e.event,"registration_open",t)},expression:"event.registration_open"}})],1),e._v(" "),e.$v.event.registration_open.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid date for registration opening, before the day of the event\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-4"},[n("label",{staticClass:"label",attrs:{for:"event-create-close"}},[e._v("Registration Closes")]),e._v(" "),n("div",{staticClass:"control"},[n("masked-input",{staticClass:"input",class:{"is-danger":e.$v.event.registration_close.$error},attrs:{mask:"11/11/1111",placeholder:"mm/dd/yyyy",id:"event-create-close"},on:{blur:e.$v.event.registration_close.$touch},model:{value:e.event.registration_close,callback:function(t){e.$set(e.event,"registration_close",t)},expression:"event.registration_close"}})],1),e._v(" "),e.$v.event.registration_close.$error?n("span",{staticClass:"help is-danger"},[e._v("\n          Please enter a valid date for registration closing, between registration opening\n          and the event day\n        ")]):e._e()]),e._v(" "),n("div",{staticClass:"field column is-12"},[n("div",{staticClass:"control"},[n("label",{staticClass:"checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.current,expression:"current"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.current)?e._i(e.current,null)>-1:e.current},on:{change:function(t){var n=e.current,s=t.target,a=!!s.checked;if(Array.isArray(n)){var i=e._i(n,null);s.checked?i<0&&(e.current=n.concat([null])):i>-1&&(e.current=n.slice(0,i).concat(n.slice(i+1)))}else e.current=a}}}),e._v(" Mark this as the current event\n          ")]),e._v(" "),n("help-tag",{attrs:{text:"The current event is the event that scoutmasters will\n                            be able to register their scouts for."}})],1)])]),e._v(" "),n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",class:{"is-loading":e.creating},attrs:{disabled:e.$v.$invalid||e.creating},on:{click:function(t){t.preventDefault(),e.createEvent()}}},[e._v("Create Event")])]),e._v(" "),n("div",{staticClass:"control"},[n("button",{staticClass:"button",attrs:{disabled:e.creating},on:{click:function(t){t.preventDefault(),e.clearAndClose()}}},[e._v("Cancel")])])])])])},[],!1,null,"37d82bcb",null).exports),$={data:function(){return{displayAddEvent:!1}},computed:a()({},Object(i.b)(["orderedEvents","currentEvent","isAdmin"]),{totalEvents:function(){return this.orderedEvents.length}}),methods:{isAuthorized:function(){return"admin"===this.profile.role},toggleAdd:function(){this.displayAddEvent=!this.displayAddEvent}},components:{event:g,"event-create":C},mixins:[r.a]},y=(n("nhC+"),Object(u.a)($,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._t("title",[n("h3",{staticClass:"title is-3"},[e._v("\n      All Events ("+e._s(e.totalEvents)+" Total)\n    ")])]),e._v(" "),e.eventLoadError?n("closable-error"):e._e(),e._v(" "),e.eventLoading?n("spinner-page"):n("div",[e.isAdmin&&!e.displayAddEvent?n("button",{staticClass:"button is-primary",on:{click:function(t){e.toggleAdd()}}},[e._v("\n      Add an Event\n    ")]):e._e(),e._v(" "),n("event-create",{directives:[{name:"show",rawName:"v-show",value:e.displayAddEvent,expression:"displayAddEvent"}],on:{close:function(t){e.toggleAdd()}}}),e._v(" "),n("div",{staticClass:"event-list"},[e.orderedEvents.length<1?n("span",[n("div",{staticClass:"notification"},[n("p",[e._v("\n            No events have been added yet.\n            ")]),e.isAdmin?n("div",[n("br"),e._v(" Scoutmasters will not be able to register any scouts for events until\n              you create an event (make sure to mark it as the current semester's\n              event)\n              "),e.displayAddEvent?e._e():n("a",{on:{click:function(t){t.preventDefault(),e.toggleAdd()}}},[e._v("\n                Add the first event?\n              ")])]):e._e(),e._v(" "),n("p")])]):e._e(),e._v(" "),e._l(e.orderedEvents,function(t){return n("event",{key:t.id,attrs:{event:t,currentEvent:t.id===e.currentEvent.id}})})],2)],1)],2)},[],!1,null,null,null));t.default=y.exports}}]);
//# sourceMappingURL=admin-event~events.dfb88aa20775b5f67535.js.map