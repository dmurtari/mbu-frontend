(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"/w1Y":function(t,e,s){"use strict";s.r(e);var i=s("QbLZ"),n=s.n(i),r=s("L2JU"),o=(s("Q2AE"),s("LvDl")),a=s.n(o),l=s("4d7F"),d=s.n(l),c=(s("P6sX"),s("oCYn")),u=(s("vDqi"),s("v8uP")),v={props:{period:{type:Number,required:!0},requirements:{type:Array,default:function(){return[]}},scouts:{type:Array,default:function(){return[]}},offeringId:{type:Number,required:!0},eventId:{type:Number,required:!0}},data:function(){return{completions:{},error:"",saving:!1}},methods:{save:function(){var t=this;this.saving=!0,d.a.all(a.a.map(this.completions,function(e,s){var i=a.a.find(t.scouts,["scoutId",Number(s)]),n=a.a.without(a.a.map(a.a.split(e,","),function(t){return String(a.a.trim(t))}),null,0);return t.$store.dispatch("saveCompletions",{scoutId:s,registrationId:i.registrationId,offeringId:t.offeringId,eventId:t.eventId,completions:n})})).then(function(){t.error="",t.$emit("done")}).catch(function(){t.error="Failed to save records. Please refresh and try again."}).then(function(){t.saving=!1})},cancel:function(){this.$emit("done")}},beforeMount:function(){var t=this;a.a.forEach(this.scouts,function(e){c.a.set(t.completions,e.scoutId,a.a.join(a.a.orderBy(e.completions),", "))})},validations:{completions:{$each:{commaSeparated:u.c}}}},f=s("KHd+"),h=Object(f.a)(v,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("table",{staticClass:"table is-fullwidth"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("tbody",t._l(t.scouts,function(e){return s("tr",{key:e.scoutId},[s("td",[t._v(t._s(e.fullname))]),t._v(" "),s("td",[t._v(t._s(e.troop))]),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.completions[e.scoutId],expression:"completions[scout.scoutId]"}],staticClass:"input",class:{"is-danger":t.$v.completions.$each[e.scoutId].$invalid},attrs:{id:"completion-scout-"+e.scoutId,disabled:t.saving,"aria-labelledby":"Completions",type:"text",placeholder:"1, 2, 3, ..."},domProps:{value:t.completions[e.scoutId]},on:{blur:function(s){t.$v.completions.$each[e.scoutId].$touch},input:function(s){s.target.composing||t.$set(t.completions,e.scoutId,s.target.value)}}}),t._v(" "),t.$v.completions.$each[e.scoutId].$invalid?s("span",{staticClass:"help is-danger"},[t._v("\n            Completions must be a comma separated list of letters and/or numbers.\n          ")]):t._e()])])}))]),t._v(" "),s("div",{staticClass:"field is-grouped"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-primary",class:{"is-loading":t.saving},attrs:{disabled:t.saving||t.$v.$invalid},on:{click:function(e){e.preventDefault(),t.save()}}},[t._v("Save Completions")])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button",attrs:{disabled:t.saving},on:{click:function(e){e.preventDefault(),t.cancel()}}},[t._v("Cancel")])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("colgroup",[e("col",{staticStyle:{width:"25%"}}),this._v(" "),e("col",{staticStyle:{width:"10%"}}),this._v(" "),e("col",{staticStyle:{width:"65%"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Scout")]),this._v(" "),e("th",[this._v("Troop")]),this._v(" "),e("th",[this._v("Completed Requirements")])])])}],!1,null,null,null).exports,m={props:{period:{type:Number,required:!0},scouts:{type:Array,default:function(){return[]}},requirements:{type:Array,default:function(){return[]}},offeringId:{type:Number,required:!0},eventId:{type:Number,required:!0}},data:function(){return{editing:!1}},methods:{toggleEdit:function(){this.editing&&this.$emit("triggerRefresh"),this.editing=!this.editing}},components:{CompletionsEdit:h}},p=(s("2iTX"),Object(f.a)(m,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"attendee-container"},[t.editing?s("div",[s("h5",{staticClass:"title is-5"},[t._v("\n      Editing Completions for Period "+t._s(t.period)+"\n    ")]),t._v(" "),t.editing?s("completions-edit",{attrs:{scouts:t.scouts,period:t.period,requirements:t.requirements,offeringId:t.offeringId,eventId:t.eventId},on:{done:function(e){t.toggleEdit()}}}):t._e()],1):s("div",[s("h5",{staticClass:"title is-5"},[t._v("\n      Attendees for Period "+t._s(t.period)+"\n      "),t.scouts.length>0?s("span",[t._v("\n        ("+t._s(t.scouts.length)+")\n      ")]):t._e(),t._v(" "),t.scouts.length>0?s("div",{staticClass:"is-pulled-right"},[s("button",{staticClass:"titlebar-button button is-light",on:{click:function(e){t.toggleEdit()}}},[t._v("\n          Edit Completions\n        ")])]):t._e()]),t._v(" "),t.scouts.length<1?s("div",{staticClass:"notification"},[t._v("\n      There are no scouts attending this period.\n    ")]):s("table",{staticClass:"table is-striped is-fullwidth"},[t._m(0),t._v(" "),s("tbody",t._l(t.scouts,function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.fullname))]),t._v(" "),s("td",[t._v(t._s(e.troop))]),t._v(" "),s("td",[t._v(t._s(t._f("commaSeparated")(t._f("numAlphaSort")(e.completions))))])])}))])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Full Name")]),this._v(" "),e("th",[this._v("Troop")]),this._v(" "),e("th",[this._v("Completed Requirements")])])])}],!1,null,"904eb124",null).exports),g={props:{offeringId:{type:Number,required:!0},eventId:{type:Number,required:!0}},data:function(){return{assignees:[],loading:!1,badge:"",error:"",offering:{}}},computed:n()({},Object(r.b)(["allEvents","eventClasses"]),{event:function(){return _.find(this.allEvents,{id:this.eventId})||{}},scoutsByPeriod:function(){var t=_.map(this.assignees,function(t){var e={periods:t.assignment.periods,scout:t.scout};return e.scout.registrationId=t.registration_id,e.scout.scoutId=t.scout_id,e.scout.completions=t.assignment.completions,e});return _.reduce(t,function(t,e){return _.forEach(e.periods,function(s){t[s]?t[s].push(e.scout):t[s]=[e.scout]}),t},[])}}),methods:{clearError:function(){this.error=""},refreshDetails:function(){var t=this,e=this.eventClasses[this.eventId]||{};_.forEach(e,function(e){e.offering_id===t.offeringId&&(t.offering=e,t.assignees=e.assignees,t.badge=e.badge.name)}),this.$emit("title",this.badge+" ("+this.event.semester+" "+this.event.year+")")},scoutsForPeriod:function(t){var e=this.scoutsByPeriod[t]||{};return _.orderBy(e,"lastname")},triggerRefresh:function(){var t=this;this.loading=!0,this.$store.dispatch("getClasses",this.eventId).then(function(){t.refreshDetails(),t.error=""}).catch(function(){t.error="Unable to load class details."}).then(function(){t.loading=!1})}},created:function(){!this.eventClasses[this.eventId]||this.eventClasses[this.eventId].length<1?this.triggerRefresh():this.refreshDetails()},components:{Attendees:p}},b=Object(f.a)(g,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.error?s("closable-error",{on:{dismissed:function(e){t.clearError()}}},[t._v(t._s(t.error))]):t._e(),t._v(" "),t.loading?s("spinner-page"):s("div",[t.offering.requirements&&t.offering.requirements.length>0?s("span",[t._v("\n      Requirements are:\n      "),s("b",[t._v(t._s(t._f("commaSeparated")(t._f("numAlphaSort")(t.offering.requirements))))])]):s("span",[t._v("\n      Requirements are not available.\n    ")]),t._v(" "),t._l(3,function(e){return s("attendees",{key:e,attrs:{period:e,requirements:t.offering.requirements,offeringId:t.offeringId,eventId:t.eventId,scouts:t.scoutsForPeriod(e)},on:{triggerRefresh:function(e){t.triggerRefresh()}}})})],2)],1)},[],!1,null,null,null);e.default=b.exports},"2iTX":function(t,e,s){"use strict";var i=s("Z3ZL");s.n(i).a},"BeT/":function(t,e,s){"use strict";s.r(e);var i=/.*all\/?$/,n={data:function(){return{title:"Class Details"}},computed:{isList:function(){return i.test(this.$route.path)}},methods:{setTitle:function(t){this.title=t}},mixins:[s("fBmq").a]},r=s("KHd+"),o=Object(r.a)(n,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isList?s("h4",{staticClass:"title is-4"},[t._v("All Classes")]):s("h4",{staticClass:"title is-4"},[s("router-link",{attrs:{to:"../all"}},[t._v("\n      All Classes\n    ")]),t._v("\n    / "+t._s(t.title)+"\n  ")],1),t._v(" "),t.eventLoadError?s("closable-error"):t._e(),t._v(" "),t.eventLoading?s("spinner-page"):s("router-view",{on:{title:function(e){t.setTitle(e)}}})],1)},[],!1,null,null,null);e.default=o.exports},"JZ+F":function(t,e,s){},Z3ZL:function(t,e,s){},g6rl:function(t,e,s){"use strict";var i=s("n7ZF");s.n(i).a},k6cs:function(t,e,s){"use strict";var i=s("JZ+F");s.n(i).a},lbWM:function(t,e,s){"use strict";s.r(e);var i=s("QbLZ"),n=s.n(i),r=s("L2JU"),o=s("LvDl"),a=s.n(o),l={props:{id:{type:Number,required:!0},eventId:{type:Number,required:!0},badge:{type:String,required:!0},duration:{type:Number,required:!0},sizeInfo:{type:Object,required:!0},offeredPeriods:{type:Array,required:!0}},methods:{offeredForPeriod:function(t){return this.offeredPeriods.indexOf(t)>-1}}},d=(s("k6cs"),s("KHd+")),c=Object(d.a)(l,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v(t._s(t.badge))]),t._v(" "),s("td",[t._v(t._s(t.duration))]),t._v(" "),s("td",[t._v(t._s(t.sizeInfo.size_limit))]),t._v(" "),s("td",[t._v(t._s(t.sizeInfo.total))]),t._v(" "),t._l(3,function(e){return s("td",{key:e},[s("span",{class:{"is-light":!t.offeredForPeriod(e)}},[t._v("\n      "+t._s(t.sizeInfo[e])+"\n    ")])])}),t._v(" "),s("td",[s("router-link",{attrs:{to:t.eventId+"/"+t.id}},[t._v("\n      Details\n    ")])],1)],2)},[],!1,null,"3398853e",null).exports,u=s("Jc9L"),v={data:function(){return{eventId:0,search:""}},computed:n()({},Object(r.b)(["allEvents","eventClasses","isAdmin"]),{event:function(){return a.a.find(this.allEvents,{id:this.eventId})},classes:function(){return this.eventClasses[this.eventId]||{}},orderedClasses:function(){return a.a.orderBy(this.classes,"badge.name")},filteredOrderedClasses:function(){var t=this;return a.a.filter(this.orderedClasses,function(e){return e.badge.name.toLowerCase().indexOf(t.search.toLowerCase())>-1})}}),methods:{dismissError:function(){this.classLoadError=""},setEvent:function(t){this.eventId=t,this.hasClassInfoForEvent(t)||this.loadClasses(t)}},watch:{eventId:function(){this.dismissError()}},components:{AttendanceRow:c},mixins:[u.a]},f=(s("g6rl"),Object(d.a)(v,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("p",[t._v('\n    This page shows the number of scouts assigned to each class. You can view the completion records for\n    each scout in a class by clicking the "details" link next to each class.\n    '),t.isAdmin?s("span",[t._v(" To edit badges that are offered for an event, use the\n      "),s("router-link",{attrs:{to:"/administration/events/offerings"}},[t._v("offerings page")]),t._v(". To change a scout's badge assignments, use the\n      "),s("router-link",{attrs:{to:"/administration/scouts/assignments"}},[t._v("assignments page")]),t._v(".\n    ")],1):t._e()]),t._v(" "),s("div",{staticClass:"box class-list-filters"},[s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-6"},[s("div",{staticClass:"field is-horizontal"},[t._m(0),t._v(" "),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("events-dropdown",{on:{select:function(e){t.setEvent(e)}}})],1)])])])]),t._v(" "),s("div",{staticClass:"column is-6"},[s("div",{staticClass:"search-container field is-horizontal"},[t._m(1),t._v(" "),s("div",{staticClass:"field-body"},[s("div",{staticClass:"field"},[s("div",{staticClass:"control "},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"input is-expanded",attrs:{id:"class-list-find"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})])])])])])])]),t._v(" "),t.classLoadError?s("closable-error",{on:{dismissed:function(e){t.dismissError()}}},[t._v(t._s(t.classLoadError))]):t._e(),t._v(" "),t.classesLoading?s("spinner-page"):s("table",{staticClass:"table is-striped is-fullwidth"},[s("thead",[s("tr",{staticClass:"meta-header"},[s("th",{attrs:{colspan:"3"}},[t._v("Class Information")]),t._v(" "),s("th",{attrs:{colspan:"4"}},[t._v("Attendance per Period")]),t._v(" "),s("th")]),t._v(" "),s("tr",[s("th",[t._v("Badge")]),t._v(" "),s("th",[t._v("Duration")]),t._v(" "),s("th",[t._v("Limit/Period")]),t._v(" "),s("th",[t._v("Total")]),t._v(" "),s("th",[t._v("1")]),t._v(" "),s("th",[t._v("2")]),t._v(" "),s("th",[t._v("3")]),t._v(" "),s("th")])]),t._v(" "),s("tbody",t._l(t.filteredOrderedClasses,function(e){return s("attendance-row",{key:e.offering_id,attrs:{id:e.offering_id,"event-id":t.eventId,badge:e.badge.name,"size-info":e.sizeInfo||{},duration:e.duration,"offered-periods":e.periods}})}))])],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field-label is-normal"},[e("label",{staticClass:"label"},[this._v("For Event:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field-label is-normal"},[e("label",{staticClass:"label",attrs:{for:"class-list-find"}},[this._v("Badge:")])])}],!1,null,"70e52e67",null));e.default=f.exports},n7ZF:function(t,e,s){}}]);
//# sourceMappingURL=classes.eed4ab2722b93e02581a.js.map